---
# Create
- name: Molecule.tests.roles.swap.conditions.create | Include vars
  run_once: true
  ansible.builtin.include_vars:
    file: ../../../../../vars/system.yml

- name: Molecule.tests.roles.swap.conditions.create | Set swap_exists for testing
  run_once: true
  ansible.builtin.set_fact:
    swap_exists:
      stdout: ""
      stdout_lines: []

- name: Molecule.tests.roles.swap.conditions.create | Assert condition for creating swap
  run_once: true
  ansible.builtin.assert:
    that: >
      (swap_exists.stdout is defined and swap_exists.stdout | length < 1) or
      (swap_exists.stdout_lines is defined and
      (swap_exists.stdout_lines | map('trim') | map('int') | sum / 1024 / 1024) | round | int != swap_file_size_mb|int)
    fail_msg: "Condition for creating swap is false"
    success_msg: "Condition for creating swap is true"
