---
# Delete
- name: Molecule.tests.roles.swap.conditions.delete | Include vars
  run_once: true
  ansible.builtin.include_vars:
    file: ../../../../../vars/system.yml

- name: Molecule.tests.roles.swap.conditions.delete | Set swap_exists for testing
  run_once: true
  ansible.builtin.set_fact:
    swap_exists:
      stdout: "1048576"  # Suppose we have a 1MB swap file
      stdout_lines:
        - "1048576"

- name: Molecule.tests.roles.swap.conditions.delete | Assert condition for deleting swap
  run_once: true
  ansible.builtin.assert:
    that: (swap_exists.stdout is defined and swap_exists.stdout | length > 1) and
          ((swap_exists.stdout_lines|map('trim')|map('int')|sum / 1024 / 1024)|round|int != swap_file_size_mb|int)
    fail_msg: "Condition for deleting swap is false"
    success_msg: "Condition for deleting swap is true"
